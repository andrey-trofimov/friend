(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(){document.querySelector("main").className="";let e=document.querySelector(".vert-container");e.className="registration-page",e.innerHTML='\n\n          <h1 class="title title_registration-page">Укажи личные данные</h1>\n\n          <form>\n            <h2 class="subtitle">Придумай пароль</h2>\n\n            <label for="password" class="label">Пароль <span class="error">*</span></label>\n            <input type="password" class="input" id="password" name="password" required />\n            <p class="note" id="password-note">\n              Пароль должен состоять из 8ми символов и включать заглавную букву,\n              специальный символ и цифру\n            </p>\n\n            <label for="password-confirm" class="label">Повтори пароль <span class="error">*</span></label>\n            <input type="password" class="input" id="password-confirm" name="password-confirm" required />\n            <p class="note" id="password-confirm-note"></p>\n\n            <h2 class="subtitle">Расскажи о себе</h2>\n\n            <label for="name" class="label">Имя или псевдоним <span class="error">*</span></label>\n            <input type="text" class="input" id="name" name="name" required />\n            <p class="note" id="name-note">\n              Будет доступен только твоему психологу и личному помощнику\n            </p>\n\n            <label for="birth" class="label">Дата рождения <span class="error">*</span></label>\n            <span class="date-picker">\n              <input type="text" class="input" id="birth" name="birth" required placeholder="__ __ .__ __.__ __ __ __" /></span>\n            <p class="note" id="birth-note">\n              Для получения услуг тебе должно быть 18 или больше лет\n            </p>\n\n            <h2 class="subtitle">Укажи по желанию</h2>\n\n            <label for="email" class="label">E-mail</label>\n            <input type="email" class="input" id="email" name="email" />\n            <p class="note" id="email-note">\n              Присылаем только информацию, связанную с твоими сессиями\n            </p>\n\n            <label for="tg" class="label">Ник в Телеграм</label>\n            <input type="text" class="input" id="tg" name="tg" placeholder="@" />\n            <p class="note" id="tg-note">\n              Присылаем только информацию, связанную с твоими сессиями\n            </p>\n\n            <input type="button" class="button button_registration-page button_block" id="submit" value="Далее" />\n            \n          </form>\n          \n'}function n(){let e=document.querySelector("#password-note"),t=d.pw,n=d.pwConfirm;""==t.value&&""==n.value&&(e.innerHTML="Пароль должен состоять из 8ми символов и включать заглавную букву, специальный символ и цифру",e.className="note",t.className="input",n.className="input",v.password=!1,g.password=""),t.value!=n.value&&(e.innerHTML="Пароли не совпадают",e.className="note note_error",t.className="input input_error",n.className="input input_error",v.password=!1,g.password=""),""!=t.value&&""!=n.value&&t.value==n.value&&(e.innerHTML="",e.className="note",t.className="input input_valid",n.className="input input_valid",v.password=!0,g.password=t.value)}function a(){let e=d.userName,t=document.querySelector("#name-note"),n=/[\p{sc=Cyrillic}\d]/giu;e.value=e.value.replace(/[a-z"!#\$%&'\*\+-/=\?\^_`{\|}~@\.\:\;]/gi,""),n.test(e.value)&&(e.value=e.value.match(n).join("")),e.value.length>20&&(e.className="input input_error",t.className="note note_error",t.innerHTML=`Превышено допустимое количество символов: сократите ${e.value.length-20} символов`,v.userName=!1,g.name=""),""==e.value&&(e.className="input",t.className="note",t.innerHTML="Будет доступен только твоему психологу и личному помощнику",v.userName=!1,g.name=""),e.value.length<21&&e.value.length>0&&(e.className="input input_valid",t.className="note",t.innerHTML="Будет доступен только твоему психологу и личному помощнику",v.userName=!0,g.name=e.value)}function l(){let e=document.querySelector("#birth-note"),t=Date.now(),n=d.birth,a=[/[0-3]/,/[0-9]/,/\./,/[0-1]/,/[0-9]/,/\./,/[1-2]/,/[0-9]/,/[0-9]/,/[0-9]/],l=[],s=0;if(n.value.length>0&&"3"==n.value[0]&&(a[1]=/[0-1]/),n.value.length>3&&"1"==n.value[3]&&(a[4]=/[0-2]/),n.value.length>7&&"1"==n.value[7]&&(a[8]=/9/),n.value.length>7&&"2"==n.value[7]&&(a[8]=/0/),n.value.length>1&&"."!=n.value[2]&&(l=n.value.split(""),l.splice(2,0,"."),n.value=l.join("")),n.value.length>4&&"."!=n.value[5]&&(l=n.value.split(""),l.splice(5,0,"."),n.value=l.join("")),n.value.length>0){let e=n.value.length<10?n.value.length:10;for(let t=0;t<e;t++)l[t]=1==a[t].test(n.value[t])?n.value[t]:"";n.value=l.join("")}if(l.length>9){let e=n.value.slice(6,10),a=n.value.slice(3,5),l=n.value.slice(0,2);s=(t-Date.parse(e+"-"+a+"-"+l))/315576e5,g.birth=`${e}-${a}-${l}`}s<18.002737&&(n.className="input input_error",e.className="note note_error",e.innerHTML="Для получения услуг тебе должно быть 18 или больше лет. Необходимо согласие родителей.",v.birth=!1),s>=18.002737&&s<100&&(n.className="input input_valid",e.className="note",e.innerHTML="",v.birth=!0),s>=100&&(n.className="input input_error",e.className="note note_error",e.innerHTML=`Вам точно ${s-s%1}?`,v.birth=!1),""==n.value&&(n.className="input",e.className="note",e.innerHTML="Для получения услуг тебе должно быть 18 или больше лет. Необходимо согласие родителей.",v.birth=!1)}function s(){let e=document.querySelector("#email-note"),t=d.email;0==t.value.length?(t.className="input",e.innerHTML="Присылаем только информацию, связанную с твоими сессиями",e.className="note",v.email=!0,g.email=""):/@/g.test(t.value)?(t.className="input input_valid",e.innerHTML="Присылаем только информацию, связанную с твоими сессиями",e.className="note",v.email=!0,g.email=t.value):(t.className="input input_error",e.innerHTML="Пропущен символ @",e.className="note note_error",v.email=!1,g.email="")}function r(){let e=document.querySelector("#email-note"),t=d.email,n=/[a-z0-9!#\$%&'\*\+-/=\?\^_`{\|}~@\.]/gi,a=/[\p{sc=Cyrillic}\s]/giu;a.test(t.value)&&(e.innerHTML="Допустимы латинские символы, цифры и спец. символы.",e.className="note note_error",t.className="input input_error",t.value=t.value.replace(a,"")),n.test(t.value)&&(t.value=t.value.match(n).join(""),e.innerHTML="Присылаем только информацию, связанную с твоими сессиями",e.className="note",t.className="input")}function i(){let e=document.querySelector("#tg-note"),t=d.tg;t.value=t.value.replace(/\W/gi,""),t.value="@"+t.value,"@"==t.value&&(t.value="",t.className="input",e.innerHTML="Присылаем только информацию, связанную с твоими сессиями",e.className="note",v.tg=!0,g.tg=""),""==t.value&&(t.className="input",e.innerHTML="Присылаем только информацию, связанную с твоими сессиями",e.className="note",v.tg=!0,g.tg=""),""!=t.value&&(t.value.length>5&&(t.className="input input_valid",e.innerHTML="Присылаем только информацию, связанную с твоими сессиями",e.className="note",v.tg=!0,g.tg=t.value),t.value.length<6&&(t.className="input input_error",e.innerHTML="Ник должен быть не короче 5 символов",e.className="note note_error",v.tg=!1,g.tg=t.value))}function o(){}function u(){let e=JSON.stringify(g);fetch("https://cors-anywhere.herokuapp.com/http://158.160.4.55:49161/v1/auth/register/",{method:"POST",body:e,headers:{"Content-type":"application/json; charset=UTF-8",accept:"application/json"}}).then((e=>{if(e.status>=200&&e.status<300)return b=e.status,e;{let t=new Error(e.statusText);throw t.response=e,t}})).then((e=>e.json())).then((e=>{h=JSON.parse(e),console.log("ответ сервера ",h)})).catch((e=>{b=e.status,h=e.response,console.log("Error: "+e.message),console.log("Responce: ",h.json())})).then(function(){let e="",t=document.querySelector(".registration-page");t.className="vert-container vert-container_id-msg",t.innerHTML='\n\n        <p class="id-msg" id="id-msg">&nbsp;</p>\n        <input\n        class="button button_registration-page button_go-to-profile"\n        id="submit"\n        type="button"\n        value="Перейти в профиль"\n        />\n    ';let n=document.querySelector("#id-msg"),a=document.querySelector("#submit");console.log(b),console.log(h),(b=201)&&(e=`Присвоен идентификатор ${h.id.slice(0,9)}`,a.addEventListener("click",o)),(b=400)&&(e=`${h["Текст"]}`,a.value="Войти",a.addEventListener("click",(function(){document.location="/"}))),b&&201!=b&&400!=b&&(e=`Ошибка ${b}`,a.value="Обновить",a.addEventListener("click",location.reload())),n.innerHTML=e}())}function c(){let e=!0,t=d.button;for(let t in v)e&=v[t];e&&(t.className="button button_registration-page",t.addEventListener("click",u)),e||(t.className="button button_registration-page button_block",t.removeEventListener("click",u))}e.d({},{cr:()=>d,AV:()=>g,vR:()=>b,sd:()=>h,qd:()=>v});let p=document.getElementById("submit"),m=document.getElementById("phone"),d={phone:m,pw:"",pwConfirm:"",userName:"",birth:"",email:"",tg:"",button:p},v={password:!1,userName:!1,birth:!1,email:!0,tg:!0},g={phone:"",password:"",name:"",birth:"",tg:"",email:""},h={},b="";document.addEventListener(onload,([].forEach.call(document.querySelectorAll("#phone"),(function(e){var t;function n(e){e.keyCode&&(t=e.keyCode),this.selectionStart<3&&e.preventDefault();var n="+7 (___) ___ __ __",a=0,l=n.replace(/\D/g,""),s=this.value.replace(/\D/g,""),r=n.replace(/[_\d]/g,(function(e){return a<s.length?s.charAt(a++)||l.charAt(a):e}));-1!=(a=r.indexOf("_"))&&(a<5&&(a=3),r=r.slice(0,a));var i=n.substr(0,this.value.length).replace(/_+/g,(function(e){return"\\d{1,"+e.length+"}"})).replace(/[+()]/g,"\\$&");(!(i=new RegExp("^"+i+"$")).test(this.value)||this.value.length<5||t>47&&t<58)&&(this.value=r),"blur"==e.type&&this.value.length<5&&(this.value="")}e.addEventListener("input",n,!1),e.addEventListener("focus",n,!1),e.addEventListener("blur",n,!1),e.addEventListener("keydown",n,!1)})),m.addEventListener("change",(function(){let e=d.phone,n=document.querySelector("#phone-note"),a=d.button,l="",s={1:"Не хватает одной цифры",2:"Не хватает две цифры",3:"Не хватает три цифры",4:"Не хватает четыре цифры",5:"Не хватает пять цифр",6:"Не хватает шесть цифр",7:"Не хватает семь цифр",8:"Не хватает восемь цифр",9:"Не хватает девять цифр"};if(e.value.length>3&&e.value.length<18){let l=11-e.value.match(/\d/g).join("").length;e.className="input input_enter-page input_error",n.className="note note_error",n.innerHTML=s[l],a.removeEventListener("click",t)}18==e.value.length&&(a.addEventListener("click",t),l=e.value.match(/[\+\d]/g).join("")),g.phone=l})),void m.addEventListener("input",(function(){let e=d.phone,t=document.querySelector("#phone-note"),n=d.button;18==e.value.length&&(e.className="input input_enter-page input_valid",t.className="note",t.innerHTML="",n.className="button button_enter-page"),e.value.length<18&&(e.className="input input_enter-page",t.className="note",t.innerHTML="",n.className="button button_enter-page button_block")}))));let _=document.querySelector("main");function N(){let e=document.getElementById("password"),t=document.getElementById("password-confirm"),o=document.getElementById("name"),u=document.getElementById("birth"),p=document.getElementById("email"),m=document.getElementById("tg"),v=document.querySelectorAll(".input");d.pw=e,d.pwConfirm=t,d.userName=o,d.birth=u,d.email=p,d.tg=m,d.button=document.querySelector("#submit"),e.addEventListener("change",n),t.addEventListener("change",n),o.addEventListener("input",a),u.addEventListener("input",l),p.addEventListener("input",r),p.addEventListener("change",s),m.addEventListener("input",i),v.forEach((e=>e.addEventListener("change",c)))}new MutationObserver((e=>{for(let t of e)for(let e of t.addedNodes)e instanceof HTMLElement&&e.matches("form")&&N()})).observe(_,{childList:!0,subtree:!0})})();